<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Piattaforma - Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000000;
            color: #ffffff;
            min-height: 100vh;
            padding: 2rem 0;
        }

        .hero-section {
            text-align: center;
            padding: 2rem 0 3rem;
            margin-bottom: 2rem;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            animation: fadeInUp 0.8s ease-out;
        }

        .hero-subtitle {
            font-size: 1.3rem;
            opacity: 0.8;
            margin-bottom: 0.5rem;
            animation: fadeInUp 1s ease-out;
        }

        .hero-description {
            font-size: 1rem;
            opacity: 0.6;
            animation: fadeInUp 1.2s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .sections-container {
            display: grid;
            grid-template-columns: 1fr 1.2fr 1fr;
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .section-card {
            background: #1a1a1a;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            border: 1px solid #2a2a2a;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title i {
            font-size: 1.8rem;
        }

        /* Sezione Appuntamenti */
        .appointment-item {
            background: #252525;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid #667eea;
        }

        .appointment-date {
            font-size: 0.85rem;
            color: #999;
            margin-bottom: 0.5rem;
        }

        .appointment-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .appointment-location {
            font-size: 0.9rem;
            color: #aaa;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #666;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Sezione Dove Sono */
        .location-card {
            background: #252525;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .location-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: #333;
        }

        .location-content {
            padding: 1.5rem;
        }

        .location-name {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .location-address {
            color: #aaa;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .location-time {
            background: #333;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .location-link {
            display: inline-block;
            padding: 0.6rem 1.5rem;
            background: #4285f4;
            color: white;
            text-decoration: none;
            border-radius: 25px;
            transition: all 0.3s;
        }

        .location-link:hover {
            background: #5a95f5;
            color: white;
            transform: translateY(-2px);
        }

        /* Sezione Wishlist */
        .wishlist-item {
            background: #252525;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s;
            border: 1px solid #2a2a2a;
        }

        .wishlist-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(255, 255, 255, 0.1);
        }

        .wishlist-item-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .wishlist-item-desc {
            color: #aaa;
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }

        .wishlist-item-link {
            display: inline-block;
            color: #667eea;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .wishlist-item-link:hover {
            color: #8a9ff5;
        }

        .priority-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
        }

        .priority-alta { background: #dc3545; color: white; }
        .priority-media { background: #ffc107; color: #000; }
        .priority-bassa { background: #6c757d; color: white; }

        .footer {
            text-align: center;
            padding: 3rem 0 2rem;
            color: #666;
            font-size: 0.9rem;
            margin-top: 4rem;
        }

        /* Login Icon */
        .login-icon {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .login-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        .login-icon i {
            font-size: 1.5rem;
        }

        @media (max-width: 992px) {
            .sections-container {
                grid-template-columns: 1fr;
            }

            .hero-title {
                font-size: 2rem;
            }

            .login-icon {
                width: 45px;
                height: 45px;
                top: 1rem;
                right: 1rem;
            }

            .login-icon i {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Login Icon -->
    <a href="{{ url_for('login') }}" class="login-icon" title="Accedi">
        <i class="bi bi-box-arrow-in-right"></i>
    </a>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <h1 class="hero-title" id="greeting">
                <i class="bi bi-graph-up-arrow"></i> Ciao!
            </h1>
            <p class="hero-subtitle" id="claim">
                L'unico hub centrale di Zara
            </p>
            <p class="hero-description" id="description">
                So perché sei qui ma non me lo ricordo
            </p>
        </div>
    </section>

    <!-- Sezioni Principali -->
    <div class="sections-container">
        <!-- Sezione Appuntamenti/Sfida (Sinistra) - Nascosta finché Game Prize non inizia -->
        {% if is_game_prize_revealed %}
        <div class="section-card">
            {% if is_game_prize_revealed %}
                <!-- Sezione Prossima Sfida (quando Game Prize è attivo) -->
                <h2 class="section-title">
                    <i class="bi bi-target"></i>
                    Prossima Sfida
                </h2>

                {% if game_challenges %}
                    {% for challenge in game_challenges %}
                    <div class="appointment-item">
                        <div class="appointment-date">
                            <i class="bi bi-lightning-charge-fill" style="color: #ffc107;"></i>
                            Sfida {{ challenge.challenge_number }}
                        </div>
                        <div class="appointment-title">{{ challenge.title }}</div>
                        {% if challenge.description %}
                        <div class="text-muted small">{{ challenge.description }}</div>
                        {% endif %}
                        {% if challenge.start_date and challenge.end_date %}
                        <div class="appointment-location" style="margin-top: 0.5rem; font-size: 0.85rem;">
                            <i class="bi bi-hourglass-split"></i>
                            {% if challenge.end_date < now|default(now()) %}
                                Completata
                            {% else %}
                                In corso
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                    <a href="{{ url_for('game_prize.dashboard') }}" class="btn btn-sm btn-primary mt-2 w-100">
                        Vedi tutte le sfide
                    </a>
                {% else %}
                    <div class="empty-state">
                        <i class="bi bi-hourglass-top"></i>
                        <p>Nessuna sfida ancora disponibile</p>
                    </div>
                {% endif %}
            {% else %}
                <!-- Sezione Prossimi Impegni (prima del Game Prize) -->
                <h2 class="section-title">
                    <i class="bi bi-calendar-check"></i>
                    Prossimi Impegni
                </h2>

                {% if appointments %}
                    {% for app in appointments %}
                    <div class="appointment-item">
                        <div class="appointment-date">
                            <i class="bi bi-clock"></i> {{ app.data_ora }}
                        </div>
                        <div class="appointment-title">{{ app.titolo }}</div>
                        {% if app.descrizione %}
                        <div class="text-muted small">{{ app.descrizione }}</div>
                        {% endif %}
                        {% if app.luogo %}
                        <div class="appointment-location">
                            <i class="bi bi-geo-alt"></i> {{ app.luogo }}
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <i class="bi bi-calendar-x"></i>
                        <p>Nessun impegno in programma</p>
                    </div>
                {% endif %}
            {% endif %}
        </div>
        {% endif %}

        <!-- Sezione Wishlist (Centro) -->
        <div class="section-card">
            <h2 class="section-title">
                <i class="bi bi-gift-fill text-danger"></i>
                Lista di Babbo Natale
            </h2>

            {% if wishlist_items %}
                {% for item in wishlist_items %}
                <div class="wishlist-item">
                    <div class="wishlist-item-title">
                        <span>{{ item.nome }}</span>
                        <span class="priority-badge priority-{{ item.priorita }}">
                            {{ item.priorita }}
                        </span>
                    </div>
                    {% if item.descrizione %}
                    <div class="wishlist-item-desc">{{ item.descrizione }}</div>
                    {% endif %}
                    {% if item.link %}
                    <a href="{{ item.link }}" target="_blank" class="wishlist-item-link">
                        <i class="bi bi-link-45deg"></i> Vedi prodotto
                    </a>
                    {% endif %}
                </div>
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    <i class="bi bi-gift"></i>
                    <p>La lista è vuota al momento.<br>Tornerò presto con nuove idee!</p>
                </div>
            {% endif %}
        </div>

        <!-- Sezione Dove Sono (Destra) - Nascosta fino a Game Prize -->
        {% if is_game_prize_revealed %}
        <div class="section-card">
            <h2 class="section-title">
                <i class="bi bi-geo-alt-fill text-warning"></i>
                Dove Sono
            </h2>

            {% if current_location %}
                <div class="location-card">
                    {% if current_location.immagine_url %}
                    <img src="{{ current_location.immagine_url }}" alt="{{ current_location.nome_luogo }}" class="location-image">
                    {% else %}
                    <div class="location-image" style="display: flex; align-items: center; justify-content: center;">
                        <i class="bi bi-geo-alt" style="font-size: 3rem; color: #666;"></i>
                    </div>
                    {% endif %}

                    <div class="location-content">
                        <div class="location-name">{{ current_location.nome_luogo }}</div>

                        {% if current_location.indirizzo %}
                        <div class="location-address">
                            <i class="bi bi-geo"></i> {{ current_location.indirizzo }}
                        </div>
                        {% endif %}

                        {% if current_location.orario %}
                        <div class="location-time">
                            <i class="bi bi-clock"></i> {{ current_location.orario }}
                        </div>
                        {% endif %}

                        {% if current_location.note %}
                        <p class="text-muted small mt-2">{{ current_location.note }}</p>
                        {% endif %}

                        {% if current_location.google_maps_link %}
                        <a href="{{ current_location.google_maps_link }}" target="_blank" class="location-link">
                            <i class="bi bi-map"></i> Apri in Maps
                        </a>
                        {% endif %}
                    </div>
                </div>
            {% else %}
                <div class="empty-state">
                    <i class="bi bi-question-circle"></i>
                    <p>Al momento non esisto,<br>torna più tardi.</p>
                </div>
            {% endif %}
        </div>
        {% endif %}
    </div>

    <!-- Game Prize Section (Password Protected) -->
    <div class="container mt-5">
        {% if game_admin_authenticated %}
            <!-- Password Authenticated - Show Game Prize Content -->
            {% if is_game_prize_revealed %}
                <!-- Game Prize Active Section -->
                <div class="section-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center; padding: 3rem;">
                    <h2 class="section-title" style="color: white; margin-bottom: 1rem;">
                        <i class="bi bi-star-fill"></i> Game Prize è Attivo!
                    </h2>
                    <p style="font-size: 1.1rem; margin-bottom: 1.5rem;">
                        Il gioco del tuo 25esimo compleanno è iniziato! Accedi e inizia a giocare per competere con i tuoi amici.
                    </p>
                    <div class="d-flex gap-2 justify-content-center flex-wrap">
                        <a href="{{ url_for('game_prize.dashboard') }}" class="btn btn-light btn-lg fw-bold">
                            🎮 Accedi al Game Prize
                        </a>
                        <a href="{{ url_for('game_prize.leaderboard') }}" class="btn btn-outline-light btn-lg fw-bold">
                            📊 Visualizza Classifica
                        </a>
                        <a href="{{ url_for('logout_game_admin') }}" class="btn btn-outline-light btn-lg fw-bold">
                            🔓 Esci
                        </a>
                    </div>
                </div>
            {% else %}
                <!-- Game Prize Countdown Section -->
                <div class="section-card" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: white; text-align: center; padding: 3rem; border-radius: 15px;">
                    <h2 class="section-title" style="color: white; margin-bottom: 2rem;">
                        <i class="bi bi-hourglass-split"></i> Qualcosa di Speciale in Arrivo...
                    </h2>

                    <p style="font-size: 1.1rem; margin-bottom: 2rem;">
                        Il Game Prize ti aspetta il <strong>25 Gennaio 2026</strong> per il tuo 25esimo compleanno!
                    </p>

                    <!-- Mini Countdown -->
                    <div class="row g-3 mb-3" style="max-width: 600px; margin: 0 auto;">
                        <div class="col-6 col-md-3">
                            <div style="background: rgba(255,255,255,0.1); border-radius: 10px; padding: 15px; backdrop-filter: blur(10px);">
                                <div style="font-size: 2rem; font-weight: bold; font-family: 'Courier New', monospace;" id="mini-days">000</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Giorni</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div style="background: rgba(255,255,255,0.1); border-radius: 10px; padding: 15px; backdrop-filter: blur(10px);">
                                <div style="font-size: 2rem; font-weight: bold; font-family: 'Courier New', monospace;" id="mini-hours">00</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Ore</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div style="background: rgba(255,255,255,0.1); border-radius: 10px; padding: 15px; backdrop-filter: blur(10px);">
                                <div style="font-size: 2rem; font-weight: bold; font-family: 'Courier New', monospace;" id="mini-minutes">00</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Minuti</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div style="background: rgba(255,255,255,0.1); border-radius: 10px; padding: 15px; backdrop-filter: blur(10px);">
                                <div style="font-size: 2rem; font-weight: bold; font-family: 'Courier New', monospace;" id="mini-seconds">00</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Secondi</div>
                            </div>
                        </div>
                    </div>

                    <p style="font-size: 0.95rem; opacity: 0.8; margin-bottom: 2rem;">
                        Un gioco epico con 12 sfide, indizi settimanali, una classifica dal vivo e un vincitore che verrà rivelato a sorpresa!
                    </p>

                    <div class="d-flex gap-2 justify-content-center flex-wrap">
                        <a href="{{ url_for('game_prize_reveal') }}" class="btn btn-primary btn-lg fw-bold">
                            👀 Visualizza il Countdown Completo
                        </a>
                        <a href="{{ url_for('logout_game_admin') }}" class="btn btn-outline-primary btn-lg fw-bold">
                            🔓 Esci
                        </a>
                    </div>
                </div>

                <script>
                    // Mini countdown nella home
                    function updateMiniCountdown() {
                        const targetDate = new Date('2026-01-25T00:00:00').getTime();
                        const now = new Date().getTime();
                        const timeRemaining = targetDate - now;

                        if (timeRemaining > 0) {
                            const days = Math.floor(timeRemaining / (1000 * 60 * 60 * 24));
                            const hours = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                            const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
                            const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);

                            document.getElementById('mini-days').textContent = String(days).padStart(3, '0');
                            document.getElementById('mini-hours').textContent = String(hours).padStart(2, '0');
                            document.getElementById('mini-minutes').textContent = String(minutes).padStart(2, '0');
                            document.getElementById('mini-seconds').textContent = String(seconds).padStart(2, '0');
                        }
                    }

                    // Update on page load
                    document.addEventListener('DOMContentLoaded', updateMiniCountdown);

                    // Update every second
                    setInterval(updateMiniCountdown, 1000);
                </script>
            {% endif %}
        {% else %}
            <!-- Password Protected - Show Password Modal -->
            <div class="section-card" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: white; text-align: center; padding: 3rem; border-radius: 15px;">
                <h2 class="section-title" style="color: white; margin-bottom: 2rem;">
                    <i class="bi bi-lock-fill"></i> Accesso Protetto
                </h2>

                <p style="font-size: 1.1rem; margin-bottom: 2rem;">
                    Questo contenuto è protetto da password. Inserisci la password per accedere.
                </p>

                <div style="max-width: 400px; margin: 0 auto;">
                    <form method="POST" action="{{ url_for('verify_game_password') }}">
                        <div class="mb-3">
                            <input type="password"
                                   name="game_password"
                                   class="form-control form-control-lg"
                                   placeholder="Inserisci la password..."
                                   required
                                   style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; font-size: 1.1rem;">
                        </div>
                        <button type="submit" class="btn btn-primary btn-lg fw-bold w-100">
                            🔓 Accedi
                        </button>
                    </form>
                </div>

                <p style="font-size: 0.9rem; opacity: 0.6; margin-top: 2rem;">
                    La password ti verrà fornita quando il gioco sarà pronto.
                </p>
            </div>
        {% endif %}
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 Matteo Zaramella. Made with ☕ and a lot of procrastination.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Rotazione random di saluti, claim e descrizioni
        const greetings = [
            "Ciao!",
            "Buongiorno!",
            "Buon pomeriggio!",
            "Buonasera!",
            "Ehilà!",
            "Bentornato!",
            "Hey!",
            "Salve!",
            "Ciao ciao!",
            "Eccoci qui!"
        ];

        const claims = [
            "L'unico hub centrale di Zara",
            "Il posto dove Zara tiene traccia di tutto",
            "Quartier generale di Zara",
            "Il cervello digitale di Zara",
            "L'archivio personale di Zara",
            "Il centro operativo di Zara",
            "La base segreta di Zara",
            "Il pannello di controllo di Zara"
        ];

        const descriptions = [
            "So perché sei qui ma non me lo ricordo",
            "Probabilmente ti ho dato questo link, forse",
            "Benvenuto nel mio angolo di internet ordinato",
            "Sì, è proprio quello che pensi",
            "Non chiedere, è complicato",
            "La risposta è: dipende",
            "Tutto sotto controllo, più o meno",
            "Organizzato caos digitale"
        ];

        function getRandomItem(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        // Imposta testi random al caricamento
        document.addEventListener('DOMContentLoaded', function() {
            const greetingEl = document.getElementById('greeting');
            const claimEl = document.getElementById('claim');
            const descriptionEl = document.getElementById('description');

            greetingEl.innerHTML = '<i class="bi bi-graph-up-arrow"></i> ' + getRandomItem(greetings);
            claimEl.textContent = getRandomItem(claims);
            descriptionEl.textContent = getRandomItem(descriptions);
        });
    </script>
</body>
</html>
